library(Rsamtools)
knitr::opts_chunk$set(echo = TRUE)
?scanBam
bam <- scanBam("~/github/sars_cov_2/result/SRR10971381_MN908947_mapped.bam")
bam
names(bam)
class(bam)
length(bam)
str(bam)
bamTag(bam)
?ScanBamParam
?scanBamFlag
my_param <- ScanBamParam(tag="NM", what="flag")
my_param <- ScanBamParam(tag = "NM", what = "flag")
bam <- scanBam("~/github/sars_cov_2/result/SRR10971381_MN908947_mapped.bam", param = my_param)
str(bam)
bamTag(bam)
my_param <- ScanBamParam(tag = "NM", what = "flag")
bam <- scanBam("~/github/sars_cov_2/result/SRR10971381_MN908947_mapped.bam", param = my_param)
str(bam)
my_param <- ScanBamParam(tag = "NM", what = c("flag", "mapq"))
bam <- scanBam("~/github/sars_cov_2/result/SRR10971381_MN908947_mapped.bam", param = my_param)
str(bam)
my_param <- ScanBamParam(tag = "NM", what = c("flag", "mapq"))
bam_list <- scanBam("~/github/sars_cov_2/result/SRR10971381_MN908947_mapped.bam", param = my_param)
str(bam_list)
bam_list$mapq
my_param <- ScanBamParam(tag = "NM", what = c("flag", "mapq"))
bam_list <- scanBam("~/github/sars_cov_2/result/SRR10971381_MN908947_mapped.bam", param = my_param)
str(bam_list)
length(bam_list)
bam_list[[1]]
my_param <- ScanBamParam(tag = "NM", what = c("mapq"))
bam_list <- scanBam("~/github/sars_cov_2/result/SRR10971381_MN908947_mapped.bam", param = my_param)
str(bam_list)
summary(bam_list[[1]]$mapq)
summary(bam_list[[1]]$tag$NM)
hist(bam_list[[1]]$tag$NM)
hist(log1p(bam_list[[1]]$tag$NM))
summary(bam_list[[1]]$tag$NM)
table(bam_list[[1]]$tag$NM)
ls()
table(bam_list[[1]]$mapq)
summary(bam_list[[1]]$mapq)
table(bam_list[[1]]$tag$NM)
length(bam_list[[1]]$tag$NM)
table(bam_list[[1]]$tag$NM) / length(bam_list[[1]]$tag$NM)
table(bam_list[[1]]$tag$NM) / length(bam_list[[1]]$tag$NM) * 100
table(bam_list[[1]]$tag$NM)
length(bam_list[[1]]$tag$NM)
table(bam_list[[1]]$tag$NM) / 136034
prop.table(bam_list[[1]]$tag$NM)
?prop.table
prop.table(table(bam_list[[1]]$tag$NM))
prop.table(table(bam_list[[1]]$tag$NM))
prop.table(table(bam_list[[1]]$tag$NM)) * 100
options("scipen"= 10, "digits"=4)
prop.table(table(bam_list[[1]]$tag$NM))
prop.table(table(bam_list[[1]]$tag$NM)) * 100
help(options)
options("scipen"= 10)
prop.table(table(bam_list[[1]]$tag$NM)) * 100
round(prop.table(table(bam_list[[1]]$tag$NM)) * 100)
prop.table(table(bam_list[[1]]$tag$NM)) * 100
